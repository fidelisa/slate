<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Fidelisa API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;ruby&quot;,&quot;csharp&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="csharp">csharp</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='mailto:contact@fidelisa.com'>Contactez-nous</a></li>
            <li><a href='http://github.com/tripit/slate'>Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<p>Bienvenue dans la documentation de <strong>Fidelisa API</strong> !</p>

<p>L&#39;API vous permet en tant que fournisseur (Partenaire, Editeur de logiciel, Agence, &hellip;) de gérer l&#39;ensemble des actions nécessairent au fonctionnement de FIDELISA.</p>

<p>Des exemples de codes sont fournis (Ruby, C#, &hellip;) dans la partie droite de la page, d&#39;autres seront bientôt disponibles.</p>

<aside class="notice">
Pour toutes questions n'hésitez pas à nous contacter <a href="mailto:contact@fidelisa.com">contact@fidelisa.com</a>
</aside>

          <h1 id="lexique">Lexique</h1>

<h2 id="definitions">Definitions</h2>

<p><strong><em>Vocabulaire</em></strong></p>

<table><thead>
<tr>
<th>Nom</th>
<th>Définition</th>
</tr>
</thead><tbody>
<tr>
<td>Fournisseur</td>
<td>Partenaires, Editeur de logiciel, Agence, &hellip;</td>
</tr>
<tr>
<td>Point de vente</td>
<td>Point de vente, Commerce, eCommerce, &hellip;</td>
</tr>
<tr>
<td>Client</td>
<td>Client d&#39;un point de vente</td>
</tr>
</tbody></table>

<p><strong><em>Paramètres des requêtes</em></strong></p>

<table><thead>
<tr>
<th>Type</th>
<th>Definitions</th>
</tr>
</thead><tbody>
<tr>
<td>body</td>
<td>Elément du JSON envoyé au serveur</td>
</tr>
<tr>
<td>path</td>
<td>Elément de l&#39;url</td>
</tr>
<tr>
<td>query</td>
<td>Paramètres de l&#39;url</td>
</tr>
</tbody></table>

<h2 id="date-et-montant">Date et Montant</h2>

<p>Les dates sont au format YYYY-MM-DD</p>

<p>Le séparateur de décimal des montants est le “.” (point), il n’y a pas de séparateur de milliers.</p>

<h2 id="boolean">Boolean</h2>

<p>Les filtres des requêtes de type boolean ont trois positions :</p>

<table><thead>
<tr>
<th>Valeur du filtre</th>
<th>Réponse de la requête</th>
</tr>
</thead><tbody>
<tr>
<td>t</td>
<td>les éléments qui valident le filtre</td>
</tr>
<tr>
<td>f</td>
<td>les éléments qui ne valident pas le filtre</td>
</tr>
<tr>
<td></td>
<td>tous les éléments.</td>
</tr>
</tbody></table>

<h3 id="exemple">Exemple</h3>

<p>Si je souhaite les gains spéciaux consomés, je vais utiliser la requête suivante:</p>

<p><code class="prettyprint">/api/customers/{customer_id}/specialgains?user=t</code></p>

<p>Pour les non consomés :</p>

<p><code class="prettyprint">/api/customers/{customer_id}/specialgains?user=f</code></p>

<p>Pour tous les gains :</p>

<p><code class="prettyprint">/api/customers/{customer_id}/specialgains</code></p>

          <h1 id="authentification">Authentification</h1>

<h2 id="provider">Provider</h2>

<blockquote>
<p>Calcul de la cle</p>
</blockquote>
<pre class="highlight plaintext"><code>FIDELISA_JETON est un jeton aléatoire (différent à chaque appel)

FIDELISA_PROVIDER_KEY correspond au calcul de la signature avec comme paramètres :
  request : concatenation de FIDELISA_PROVIDER et FIDELISA_JETON.
  secret_key : FIDELISA_PROVIDER
</code></pre>

<p>Ces requêtes nécessitent les droits fournisseur (ex: Initialisation d&#39;un shop).</p>

<p>Dans le header de la requête ajouter les éléments suivants :</p>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>FIDELISA_JETON</td>
<td>code à usage unique généré par le provider</td>
</tr>
<tr>
<td>FIDELISA_PROVIDER</td>
<td>code Fidelisa fourni par Fidelisa</td>
</tr>
<tr>
<td>FIDELISA_PROVIDER_KEY</td>
<td>signature de la requête</td>
</tr>
</tbody></table>

<h2 id="shop">Shop</h2>

<blockquote>
<p>Calcul de la cle</p>
</blockquote>
<pre class="highlight plaintext"><code>FIDELISA_JETON est un jeton aléatoire (différent à chaque appel)

FIDELISA_PROVIDER_KEY correspond au calcul de la signature avec comme paramètres :
  request : concatenation de FIDELISA_PROVIDER et FIDELISA_JETON.
  secret_key : FIDELISA_PROVIDER

FIDELISA_APIUSER_KEY correspond au calcul de la [signature](#Signature) avec comme paramètres :
  request : concatenation de FIDELISA_APIUSER et FIDELISA_JETON.
  secret_key : FIDELISA_APIUSER
</code></pre>

<p>Ces requêtes nécessitent les droits point de vente (ex: la création d’un client).</p>

<p>Dans le header de la requête ajouter les éléments suivants :</p>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>FIDELISA_JETON</td>
<td>code à usage unique généré par le provider</td>
</tr>
<tr>
<td>FIDELISA_PROVIDER</td>
<td>code Fidelisa fourni par Fidelisa</td>
</tr>
<tr>
<td>FIDELISA_PROVIDER_KEY</td>
<td>signature de la requête</td>
</tr>
<tr>
<td>FIDELISA_APIUSER</td>
<td>code du commerce retourné lors de l’appel du init/shop (champ uuid du json)</td>
</tr>
<tr>
<td>FIDELISA_APIUSER_KEY</td>
<td><a href="#signature">signature de la requête</a></td>
</tr>
</tbody></table>

          <h1 id="exemples-de-code">Exemples de code</h1>

<h2 id="signature">Signature</h2>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">sign_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">)</span>
  <span class="c1">#encode base 64</span>
  <span class="n">policy</span> <span class="o">=</span> <span class="no">Base64</span><span class="p">.</span><span class="nf">strict_encode64</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

  <span class="c1"># Sign policy with secret key</span>
  <span class="n">digest</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'sha1'</span><span class="p">)</span>
  <span class="n">hmac</span><span class="o">=</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">policy</span><span class="p">)</span>

  <span class="c1"># encode base 64</span>
  <span class="n">signature</span> <span class="o">=</span> <span class="no">Base64</span><span class="p">.</span><span class="nf">strict_encode64</span><span class="p">(</span><span class="n">hmac</span><span class="p">)</span>
  <span class="n">signature</span>
<span class="k">end</span>
</code></pre>
<pre class="highlight csharp"><code><span class="k">private</span> <span class="kt">string</span> <span class="nf">SignRequest</span><span class="p">(</span><span class="kt">string</span> <span class="n">request</span><span class="p">,</span> <span class="kt">string</span> <span class="n">secretKey</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// encode base 64
</span>    <span class="kt">string</span> <span class="n">policy</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToBase64String</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">request</span><span class="p">));</span>
    <span class="c1">// hmac-sha1 with secretKey
</span>    <span class="n">var</span> <span class="n">digest</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA1</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">secretKey</span><span class="p">));</span>
    <span class="n">digest</span><span class="p">.</span><span class="nf">Initialize</span><span class="p">();</span>
    <span class="n">var</span> <span class="n">tmp</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="n">digest</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">policy</span><span class="p">)));</span>
    <span class="c1">// remove "-" and downcase
</span>    <span class="n">var</span> <span class="n">hmac</span> <span class="p">=</span> <span class="n">tmp</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="s">"-"</span><span class="p">,</span> <span class="s">""</span><span class="p">).</span><span class="nf">ToLower</span><span class="p">();</span>
    <span class="c1">// encode base64
</span>    <span class="kt">string</span> <span class="n">signature</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToBase64String</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">hmac</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">signature</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<p>Exemple de fonction permettant de calculer une signature.</p>

<h3 id="function-parameters">Function parameters</h3>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>request</td>
<td>Chaine à crypter</td>
</tr>
<tr>
<td>secret_key</td>
<td>Clé de cryptage</td>
</tr>
</tbody></table>

<h3 id="function-return">Function return</h3>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>retour</td>
<td>Chaine cryptée</td>
</tr>
</tbody></table>

<h2 id="headers">Headers</h2>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">make_hearders_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">withshop</span> <span class="o">=</span> <span class="kp">false</span><span class="p">)</span>
  <span class="n">jeton</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">99999999</span><span class="p">).</span><span class="nf">to_s</span>
  <span class="n">request</span><span class="p">[</span><span class="s2">"FIDELISA_JETON"</span><span class="p">]</span> <span class="o">=</span> <span class="n">jeton</span>
  <span class="n">request</span><span class="p">[</span><span class="s2">"FIDELISA_PROVIDER"</span><span class="p">]</span> <span class="o">=</span> <span class="vi">@provider</span>
  <span class="n">request</span><span class="p">[</span><span class="s2">"FIDELISA_PROVIDER_KEY"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sign_request</span><span class="p">(</span><span class="vi">@provider</span> <span class="o">+</span> <span class="n">jeton</span><span class="p">,</span> <span class="vi">@provider_key</span> <span class="p">)</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">withshop</span><span class="p">)</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"FIDELISA_APIUSER"</span><span class="p">]</span> <span class="o">=</span> <span class="vi">@shop</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"FIDELISA_APIUSER_KEY"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sign_request</span><span class="p">(</span><span class="vi">@shop</span> <span class="o">+</span> <span class="n">jeton</span><span class="p">,</span> <span class="vi">@shop_key</span> <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<pre class="highlight csharp"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">MakeHeadersRequest</span><span class="p">(</span><span class="n">HttpWebRequest</span> <span class="n">request</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">withshop</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Random</span> <span class="n">rnd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Random</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">jeton</span> <span class="p">=</span> <span class="n">rnd</span><span class="p">.</span><span class="nf">Next</span><span class="p">(</span><span class="m">99999999</span><span class="p">);</span>
    <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"FIDELISA_JETON"</span><span class="p">,</span> <span class="n">jeton</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
    <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"FIDELISA_PROVIDER"</span><span class="p">,</span> <span class="n">provider</span><span class="p">);</span>
    <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"FIDELISA_PROVIDER_KEY"</span><span class="p">,</span> <span class="nf">SignRequest</span><span class="p">(</span><span class="n">provider</span> <span class="p">+</span> <span class="n">jeton</span><span class="p">,</span> <span class="n">providerKey</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">withshop</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"FIDELISA_APIUSER"</span><span class="p">,</span> <span class="n">shop</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"FIDELISA_APIUSER_KEY"</span><span class="p">,</span> <span class="nf">SignRequest</span><span class="p">(</span><span class="n">shop</span> <span class="p">+</span> <span class="n">jeton</span><span class="p">,</span> <span class="n">shopKey</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Fabrique des entêtes Fidelisa d&#39;une requête</p>

<h3 id="function-parameters">Function parameters</h3>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>request</td>
<td>Requête à signer</td>
</tr>
<tr>
<td>withshop</td>
<td>Requête de type shop ? true/false</td>
</tr>
</tbody></table>

<h2 id="get">Get</h2>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">get_programs</span>
  <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="vi">@uri</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="vi">@uri</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">use_ssl</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Get</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"/api/shops/programs"</span><span class="p">)</span>
  <span class="n">make_hearders_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
  <span class="n">body</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
  <span class="n">body</span><span class="p">[</span><span class="s2">"programs"</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
<pre class="highlight csharp"><code><span class="k">public</span> <span class="n">Programs</span> <span class="nf">GetPrograms</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">String</span> <span class="n">requestUrl</span> <span class="p">=</span> <span class="n">HOST_FIDELISA</span> <span class="p">+</span> <span class="s">"/api/shops/programs"</span><span class="p">;</span>
    <span class="n">HttpWebRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">requestUrl</span><span class="p">)</span> <span class="k">as</span> <span class="n">HttpWebRequest</span><span class="p">;</span>
    <span class="nf">MakeHeadersRequest</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

    <span class="k">using</span> <span class="p">(</span><span class="n">HttpWebResponse</span> <span class="n">response</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">()</span> <span class="k">as</span> <span class="n">HttpWebResponse</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">DataContractJsonSerializer</span> <span class="n">jsonSerializer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DataContractJsonSerializer</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Programs</span><span class="p">));</span>
        <span class="n">Object</span> <span class="n">objResponse</span> <span class="p">=</span> <span class="n">jsonSerializer</span><span class="p">.</span><span class="nf">ReadObject</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">());</span>
        <span class="k">return</span> <span class="n">objResponse</span> <span class="k">as</span> <span class="n">Programs</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Exemple d&#39;appel d&#39;une fonction GET (Liste des programmes)</p>

<h3 id="function-parameters">Function parameters</h3>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
</tbody></table>

<h3 id="function-return">Function return</h3>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>retour</td>
<td>Tableaux de programmes</td>
</tr>
</tbody></table>

<h2 id="post">Post</h2>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">init_shop</span>
  <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="vi">@uri</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="vi">@uri</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">use_ssl</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"/api/shops/init"</span><span class="p">)</span>
  <span class="n">request</span><span class="p">[</span><span class="s1">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/json'</span>
  <span class="n">make_hearders_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="kp">false</span><span class="p">)</span>
  <span class="n">request</span><span class="p">.</span><span class="nf">body</span> <span class="o">=</span> <span class="p">({</span> <span class="ss">:shop</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s2">"user_email"</span> <span class="o">=&gt;</span> <span class="vi">@shop_mail</span> <span class="p">}</span> <span class="p">}).</span><span class="nf">to_json</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
  <span class="n">body</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>
<pre class="highlight csharp"><code><span class="k">public</span> <span class="n">Shop</span> <span class="nf">InitShop</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">String</span> <span class="n">requestUrl</span> <span class="p">=</span> <span class="n">HOST_FIDELISA</span> <span class="p">+</span> <span class="s">"/api/shops/init"</span><span class="p">;</span>
    <span class="n">HttpWebRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">requestUrl</span><span class="p">);</span>
    <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>
    <span class="nf">MakeHeadersRequest</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/json; charset=utf-8"</span><span class="p">;</span>

    <span class="n">Shop</span> <span class="n">shop</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Shop</span> <span class="p">{</span> <span class="n">userMail</span> <span class="p">=</span> <span class="n">shopMail</span> <span class="p">};</span>
    <span class="n">DataContractJsonSerializer</span> <span class="n">ser</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DataContractJsonSerializer</span><span class="p">(</span><span class="n">shop</span><span class="p">.</span><span class="nf">GetType</span><span class="p">());</span>
    <span class="n">MemoryStream</span> <span class="n">ms</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">WriteObject</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">shop</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">json</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">ms</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">());</span>
    <span class="n">StreamWriter</span> <span class="n">writer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">());</span>
    <span class="n">writer</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
    <span class="n">writer</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

    <span class="k">using</span> <span class="p">(</span><span class="n">HttpWebResponse</span> <span class="n">response</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">()</span> <span class="k">as</span> <span class="n">HttpWebResponse</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">DataContractJsonSerializer</span> <span class="n">jsonSerializer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DataContractJsonSerializer</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Shop</span><span class="p">));</span>
        <span class="n">Object</span> <span class="n">objResponse</span> <span class="p">=</span> <span class="n">jsonSerializer</span><span class="p">.</span><span class="nf">ReadObject</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">());</span>
        <span class="k">return</span> <span class="n">objResponse</span> <span class="k">as</span> <span class="n">Shop</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>

<p>Exemple d&#39;appel d&#39;une fonction POST (Initialisation du shop)</p>

<h3 id="function-parameters">Function parameters</h3>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
</tbody></table>

<h3 id="function-return">Function return</h3>

<table><thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>retour</td>
<td>Le shop initialisé</td>
</tr>
</tbody></table>

          <h1 id="shops">Shops</h1>

<h2 id="initialisation">Initialisation</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"shop"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"user_email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"test3@fidelisa.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"test3"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"619E8B5AAD5E48138881C5E7774C86B2"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FrZN6UChpqXBRKVExXVB"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user_email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"test3@fidelisa.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet d’initialiser la relation entre le point de vente et Fidelisa</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#provider">Provider</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/shops/init</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p><strong><em>Shop</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_email</td>
<td>body</td>
<td>Email du point de vente</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="visualisation">Visualisation</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"test3"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"619E8B5AAD5E48138881C5E7774C86B2"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FrZN6UChpqXBRKVExXVB"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user_email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de visualiser un point de vente</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#provider">Provider</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/shops/{ShopId}</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ShopId</td>
<td>path</td>
<td>UUID du point de vente</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="liste">Liste</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"shops"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Test 1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"YAZX2TLVO19DEFVDFF8M"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"user_email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"bva7nntn1zfpn4uhvzaw@fidelisa.com"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Test 2"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"D0114EE251D14C5180991418736A6ACC"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"RCGQDPWTRQS2XZCHWEZB"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"user_email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"9bpxdq5hzzmuuayovbfx@fidelisa.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer la liste des points de vente attachés au fournisseur</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#provider">Provider</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/shops</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="categories">Categories</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"categories"</span><span class="p">:</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"subtotal1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBTOTAL1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subtotal2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBTOTAL2"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subtotal3"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBTOTAL3"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subtotal4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subtotal5"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subtotal6"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subtotal7"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subtotal8"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subtotal9"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer un tableau des catégories paramétrées par le point de vente</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#provider">Provider</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/shops/categories</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="programmes">Programmes</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"programs"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Carte VIP"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"67B222DC2A92672CA8E9D2C6DCB785CB"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Carte Privilèges"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"8853A37D20967C9E099184814805AC31"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer la liste des programmes d&#39;un commerce</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#provider">Provider</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/shops/programs</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

          <h1 id="customers">Customers</h1>

<h2 id="creation">Creation</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"customer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"client@monmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"0123456789"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"Pierre"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"Martin"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"birth_day"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w">
    </span><span class="nt">"birth_month"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SAVOIE TECHNOLAC"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"zipcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"73370"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LE BOURGET DU LAC"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FR"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"points"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="nt">"replace_points"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"reason"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Initialisation de la carte"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pierre@martin.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+33763454341"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CKHVAK1G8XZINR73FIKF"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-05-04 15:25:10"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-05-04 15:25:13"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pierre"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Martin"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Boy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"birth_day"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
  </span><span class="nt">"birth_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"birth_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">1985</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FR"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"local_phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0763454341"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lot_import"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"has_smartphone"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"init_sms_sent"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"present_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"first_mobil_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"init_mail_sent"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"facebook_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fr"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"communication_channel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mail"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"interne"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"719D4DFD14DE412488A01F9747346D6D"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"createby_pos"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"disallow_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"godfather_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Notes"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4F09958289134A21B3009B0AE07731C9"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"third_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"234 rue de la place"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allée 34"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"zipcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75014"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Paris"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tag1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULIER"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tag2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SERVICES"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tag3"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bo"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4F09958289134A21B3009B0AE07731C9"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de créer un client pour le point de vente</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/customers</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p><strong><em>Customer</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>body</td>
<td>Email</td>
</tr>
<tr>
<td>phone</td>
<td>body</td>
<td>Phone</td>
</tr>
<tr>
<td>first_name</td>
<td>body</td>
<td> Prénom</td>
</tr>
<tr>
<td>last_name</td>
<td>body</td>
<td>Nom</td>
</tr>
<tr>
<td>birth_day</td>
<td>body</td>
<td>Jour anniversaire (facultatif)</td>
</tr>
<tr>
<td>birth_month</td>
<td>body</td>
<td>Mois anniversaire  (facultatif)</td>
</tr>
<tr>
<td>third_id</td>
<td> body</td>
<td>ID tiers géré par le fournisseur</td>
</tr>
</tbody></table>

<p><em>Les paramètres suivants permettent d&#39;initialiser (ou d&#39;ajouter)
 des points à la carte du client créé (ou existant)</em></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>points</td>
<td>body</td>
<td>Nombre de points (facultatif)</td>
</tr>
<tr>
<td>replace_points</td>
<td>body</td>
<td>Remplace les points existants (facultatif)</td>
</tr>
<tr>
<td>reason</td>
<td>body</td>
<td>Raison de la mise en place des points (facultatif)</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>201</td>
<td>Created</td>
</tr>
</tbody></table>

<h2 id="visualisation">Visualisation</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"client@monmail.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"phone"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"0123456789"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"first_name"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"Pierre"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last_name"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"Martin"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Premium"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-01-09 16:17:21"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-04-12 17:22:14"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3028957454648"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"48.83958350613"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Boy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"birth_day"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
  </span><span class="nt">"birth_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
  </span><span class="nt">"birth_year"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FR"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"local_phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0650835162"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lot_import"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"has_smartphone"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"init_sms_sent"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"present_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-01-09 16:46:29"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"first_mobil_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-01-09 16:25:12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"init_mail_sent"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"facebook_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fr"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"communication_channel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Notification"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"interne"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0BEB6B01BAFA43AA859567F67C4480AB"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"createby_pos"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"disallow_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"godfather_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9091E19929B54E1FB7C9DCACB5C1DF09"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"third_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"zipcode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tag1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tag2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tag3"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"None"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de voir un client pour le point de vente</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers/{customer_id}</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="suppression">Suppression</h2>

<p>Permet de supprimer un client pour le point de vente</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE /api/customers/{customer_id}</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="liste">Liste</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"customers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"client@monmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"0123456789"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Pierre"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Martin"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Premium"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Resultat JSON (Avec option pages=t)</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"pages"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer la liste des clients d’un point de vente</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Exemple</th>
</tr>
</thead><tbody>
<tr>
<td>without_card</td>
<td>path</td>
<td>Filtre les clients sans carte</td>
<td>without_card=t</td>
</tr>
<tr>
<td>email</td>
<td>path</td>
<td>Filtre les clients avec cette email (non sensible à la casse)</td>
<td> email=monemail@mail.com</td>
</tr>
<tr>
<td>phone</td>
<td>path</td>
<td>Filtre les clients avec ce n° de téléphone norme local</td>
<td>phone=0123456789</td>
</tr>
<tr>
<td>third_id</td>
<td>path</td>
<td>Filtre les clients par ID tiers</td>
<td>third_id=1234567</td>
</tr>
<tr>
<td>devices</td>
<td>path</td>
<td>Filtre les clients qui ont activés les notifications push</td>
<td>devices=t</td>
</tr>
<tr>
<td>date</td>
<td>path</td>
<td>Filtre les clients créés depuis la date</td>
<td>date=2016-07-02</td>
</tr>
<tr>
<td>date_update</td>
<td>path</td>
<td>Filtre les clients modifiés depuis la date</td>
<td>date_update=2016-07-02</td>
</tr>
</tbody></table>

<h3 id="pages-parameters">Pages Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
<th>Exemple</th>
</tr>
</thead><tbody>
<tr>
<td>page</td>
<td>path</td>
<td>Renvoie la liste par lot de client, le nombre de clients est définie par le paramètre perpage.</td>
<td>page=10</td>
</tr>
<tr>
<td>perpage</td>
<td>path</td>
<td>Permet de définir le nombre de clients par page, la valeur par défaut 50.</td>
<td> perpage=200</td>
</tr>
<tr>
<td>pages</td>
<td>path</td>
<td>Permet de connaitre le nombre total de pages</td>
<td> pages=t</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="cartes">Cartes</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"cards"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1DA03451947C4B91A0EAE4099AD01E26"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Carte Privilèges"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"points"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"expired_at"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-06-14"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer la liste des cartes d&#39;un client</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers/{customer_id}/cards</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="date-d-39-expiration">Date d&#39;expiration</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"1DA03451947C4B91A0EAE4099AD01E26"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-06-20"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"reset"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de modifier la date d&#39;expiration d&#39;une carte d&#39;un client</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/customers/{customer_id}/cards/expired_at</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>body</td>
<td>UUID de la carte (facultatif)</td>
</tr>
<tr>
<td>date</td>
<td>body</td>
<td> Date d&#39;expiration de la carte</td>
</tr>
<tr>
<td>reset</td>
<td>body</td>
<td>Remise à zero des points</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<aside class="notice">
Si aucune carte n'est passée en paramètre, c'est la carte par défaut du client qui est expirée
</aside>

<h2 id="parrain">Parrain</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"D7BE44C125024FD299AFF47156227660"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pierre"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Martin"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer le parrain d&#39;un client.</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers/:customer_id/godfather</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="filleuls">Filleuls</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"customers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"70A8A8A5E56640456C23A0D922446DF3"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Martin"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sophie"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"date_gain"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer la liste des filleuls d&#39;un client.</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers/:customer_id/godsons</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="code-barre">Code barre</h2>

<blockquote>
<p>Exemple avec une carte</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"card_id"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"1DA03451947C4B91A0EAE4099AD01E26"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"card_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"37634676873"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Exemple sans carte</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"card_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"37634676873"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de modifier le code barre d&#39;une (ou de toutes les) carte(s) d&#39;un client</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/customers/{customer_id}/card_number</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>card_id</td>
<td>body</td>
<td>UUID de la carte (facultatif)</td>
</tr>
<tr>
<td>card_number</td>
<td>body</td>
<td> Numéro de la carte</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<aside class="notice">
Si aucune carte n'est passée, le numéro de carte est appliqué à toutes les cartes
</aside>

          <h1 id="rule-basis">Rule Basis</h1>

<h2 id="visualisation">Visualisation</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"rulebasis"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SubTotal1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"item"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"N/A"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"exclude_discount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"f"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Item"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"item"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1234,4567"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"exclude_discount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer les règles liées aux programmes d&#39;un point de vente</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/rulebasis</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>query</td>
<td>UUID d&#39;un client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<aside class="notice">
Liste des types : Passage, TotalAmount, SubTotal1, SubTotal2, SubTotal3, SubTotal4, SubTotal5, SubTotal6, SubTotal7, SubTotal8, SubTotal9, Item
</aside>

          <h1 id="sales">Sales</h1>

<h2 id="creation">Creation</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"bill"</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"total"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"123.50"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-01-15"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"external_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"241367676"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"details"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SubTotal1"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"123.50"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"quantity"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="w">
       </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"type"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"Item"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"item"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"amount"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"12.50"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"quantity"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"bill"</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-01-15"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"123.5"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"errors"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"type"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"Item"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"item"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"11234"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"amount"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"12.50"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"quantity"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"error"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"Not Use"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet d’ajouter des ventes pour un client.</p>

<p>Le tableau contenant le detail des ventes correspond à l&#39;alimentation des règles des programmes. Si des détails ne correpondent à aucune règle de programme, elles sont ignorées.</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/sales/</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p><strong><em>Bill</em></strong>  </p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>total</td>
<td>body</td>
<td>Montant total l&#39;opération</td>
</tr>
<tr>
<td>date</td>
<td> body</td>
<td> Date de l&#39;opération</td>
</tr>
<tr>
<td>customer_id</td>
<td>body</td>
<td>UUID du customer</td>
</tr>
<tr>
<td>external_id</td>
<td>body</td>
<td>Identifiant externe libre</td>
</tr>
<tr>
<td>details</td>
<td>body</td>
<td>Tableau de details</td>
</tr>
</tbody></table>

<p><strong><em>Detail</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>body</td>
<td>Règle impactée par ce détail</td>
</tr>
<tr>
<td>amount</td>
<td>body</td>
<td>Montant correspondant à la règle</td>
</tr>
<tr>
<td>quantity</td>
<td>body</td>
<td>Quantité correspondant à la règle</td>
</tr>
<tr>
<td>item</td>
<td> body</td>
<td> Code de l&#39;élément du détail (types &ldquo;item&rdquo; uniquement ) (facultatif)</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>201</td>
<td>CREATED</td>
</tr>
<tr>
<td>404</td>
<td>NOT FOUND</td>
</tr>
</tbody></table>

<aside class="warning">
S'il existe des erreurs, elles sont retournées dans un tableau.
</aside>

          <h1 id="points">Points</h1>

<h2 id="ajout-remplace">Ajout/Remplace</h2>

<p>Permet d&#39;ajouter des points à une carte ou de remplacer les points d&#39;une carte.</p>

<blockquote>
<p>Avec un identifiant de carte connu</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"correction"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"points"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"card_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1DA03451947C4B91A0EAE4099AD01E26"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"replace_points"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">    
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Si le customer n&#39;a qu&#39;une seule carte, celle-ci sera créditée automatiquement</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"correction"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"points"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/corrections</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p><strong><em>Correction</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>points</td>
<td>body</td>
<td>Nombre de points à créditer sur la carte</td>
</tr>
<tr>
<td>customer_id</td>
<td> body</td>
<td> UUID du client</td>
</tr>
<tr>
<td>card_id</td>
<td>body</td>
<td>Carte du client (facultatif)</td>
</tr>
<tr>
<td>replace_points</td>
<td>body</td>
<td>Remplace les points existants (facultatif)</td>
</tr>
<tr>
<td>reason</td>
<td>body</td>
<td>Raison de la mise en place des points (facultatif)</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>201</td>
<td>CREATED</td>
</tr>
</tbody></table>

          <h1 id="notifications">Notifications</h1>

<h2 id="envoi">Envoi</h2>

<blockquote>
<p>Pour un client unique</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"customer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"alert"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Message au client"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>pour un programme</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"program"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"alert"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Message aux clients"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>pour un ensemble de clients avec des urls spécifiques</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"customers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"D407587D800ECC6C629A52CD204C6E61"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://fidelisa.com/1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://fidelisa.com/2"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"alert"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Message aux clients"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet d’envoyer une notification à un client ou à tous les clients d’un programme</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/notifications</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p><strong><em>Cas 1 : pour un client unique</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer</td>
<td>body</td>
<td> UUID du client</td>
</tr>
<tr>
<td>alert</td>
<td> body</td>
<td>Texte du message</td>
</tr>
</tbody></table>

<p><strong><em>Cas 2 : pour tous clients d&#39;un programme</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>program</td>
<td>body</td>
<td>UUID du programme</td>
</tr>
<tr>
<td>alert</td>
<td> body</td>
<td>Texte du message</td>
</tr>
</tbody></table>

<p><strong><em>Cas 3 : pour des clients</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customers</td>
<td>body</td>
<td>Tabelau de clients</td>
</tr>
<tr>
<td>alert</td>
<td> body</td>
<td>Texte du message</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

          <h1 id="gains">Gains</h1>

<h2 id="liste">Liste</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EB846456B1979BAB763DB04ECEC481C4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"512E811DB8CF4AAC943CACFD84118099"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GiftGain"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"gived_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-29 10:06:25"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-29 10:14:02"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4C0741AF77EE4410948EA9FB925A0A1A"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"card_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"48AA097CFF8146CBA809D12BAD225686"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"web"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5% sur prochain achat"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>Permet de voir la liste des cadeaux (paliers et spéciaux) d&#39;un client</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers/{customer_id}/gains</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
<tr>
<td>used</td>
<td>query</td>
<td>Filtre les gains consommés</td>
</tr>
<tr>
<td>web</td>
<td>query</td>
<td>Filtre les gains consommables uniquement sur le web</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="consommation">Consommation</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EB846456B1979BAB763DB04ECEC481C4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"512E811DB8CF4AAC943CACFD84118099"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GiftGain"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"gived_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-29 10:06:25"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-29 10:14:02"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4C0741AF77EE4410948EA9FB925A0A1A"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"48AA097CFF8146CBA809D12BAD225686"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"web"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5% sur prochain achat"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de consommer un cadeau</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers/{customer_id}/gains/{gain_id}/valid</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
<tr>
<td>gain_id</td>
<td>path</td>
<td>UUID du cadeau</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>ok</td>
</tr>
</tbody></table>

<h2 id="annuler-la-consommation">Annuler la consommation</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EB846456B1979BAB763DB04ECEC481C4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"512E811DB8CF4AAC943CACFD84118099"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GiftGain"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"gived_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-29 10:06:25"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-29 10:14:02"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4C0741AF77EE4410948EA9FB925A0A1A"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"48AA097CFF8146CBA809D12BAD225686"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"web"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5% sur prochain achat"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet d&#39;annuler la consommation d&#39;un cadeau</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers/{customer_id}/gains/{gain_id}/unvalid</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
<tr>
<td>gain_id</td>
<td>path</td>
<td>UUID du cadeau</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>ok</td>
</tr>
</tbody></table>

          <h1 id="targets">Targets</h1>

<h2 id="creation-avec-fichier">Creation (avec fichier)</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"target"</span><span class="w"> </span><span class="p">:{</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne n°1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne_201670292"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"file_id"</span><span class="p">:</span><span class="s2">"EA8C650C379E4D7C921085A39D3084D5"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CAC539ED500841229765A503715B0312"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne n°1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-05 07:29:12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-05 07:29:12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EA8C650C379E4D7C921085A39D3084D5"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BADAD0FA3EAF46CBA11CF2348F85B8F4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne_201670292"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"synced_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"D56EFC4B67084B168E9DC723F9D6F77A"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customers_count"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de créer une cible à partir d&#39;un <a href="/#upload">fichier téléchargé</a></p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/targets</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p><strong><em>Customer</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>body</td>
<td>Titre de la campagne</td>
</tr>
<tr>
<td>external_id</td>
<td>body</td>
<td>ID tiers géré par le fournisseur (facultatif)</td>
</tr>
<tr>
<td>file_id</td>
<td>body</td>
<td> ID du fichier téléchargé</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>201</td>
<td>Created</td>
</tr>
</tbody></table>

<h2 id="creation-avec-filtre">Creation (avec filtre)</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"target"</span><span class="w"> </span><span class="p">:{</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne n°1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne_201670292"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">   
      </span><span class="nt">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"with_email"</span><span class="p">:</span><span class="s2">"t"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50A271F87C934F34BEFAF12008534533"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne n°1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-05 15:30:05"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-05 15:30:05"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"with_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t"</span><span class="w">    
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"file_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BADAD0FA3EAF46CBA11CF2348F85B8F4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne_201670292"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"synced_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"D56EFC4B67084B168E9DC723F9D6F77A"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customers_count"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de créer une cible à partir d&#39;un filtre</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/targets</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p><strong><em>Customer</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>body</td>
<td>Titre de la campagne</td>
</tr>
<tr>
<td>external_id</td>
<td>body</td>
<td>ID tiers géré par le fournisseur (facultatif)</td>
</tr>
<tr>
<td>filter</td>
<td>body</td>
<td> Filtre à appliquer sur les clients</td>
</tr>
</tbody></table>

<p><strong><em>Filtre</em></strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Valeurs/exemples</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td>Utilise l&#39;applicatoin mobile</td>
<td>&rsquo;t&rsquo;</td>
</tr>
<tr>
<td>channel</td>
<td>Canal de communication</td>
<td>&lsquo;Notification&rsquo;, &#39;Mail&rsquo;</td>
</tr>
<tr>
<td>gender</td>
<td>Sexe</td>
<td>&#39;Boy&rsquo;, &#39;Girl&rsquo;</td>
</tr>
<tr>
<td>age_min</td>
<td>Age minimum</td>
<td>30</td>
</tr>
<tr>
<td>age_max</td>
<td>Age maximum</td>
<td>40</td>
</tr>
<tr>
<td>city</td>
<td>Ville</td>
<td>Le Bourget du Lac</td>
</tr>
<tr>
<td>country</td>
<td>Pays au format ISO3166</td>
<td>FR</td>
</tr>
<tr>
<td>zipcode</td>
<td>Code postal</td>
<td>78000</td>
</tr>
<tr>
<td>notes</td>
<td>Mot clé (recherche dans les notes)</td>
<td></td>
</tr>
<tr>
<td>tag1</td>
<td>Valeur du tag 1</td>
<td></td>
</tr>
<tr>
<td>tag2</td>
<td>Valeur du tag 2</td>
<td></td>
</tr>
<tr>
<td>tag3</td>
<td>Valeur du tag 3</td>
<td></td>
</tr>
<tr>
<td>last_connexion_max</td>
<td>Ne s&#39;est pas connecté depuis le AAAA-MM-DD</td>
<td>2016-07-03</td>
</tr>
<tr>
<td>last_visit_max</td>
<td>N&#39;est pas venu depuis le AAAA-MM-DD</td>
<td>2016-07-03</td>
</tr>
<tr>
<td>with_phone</td>
<td>Numéro de téléphone renseigné</td>
<td> &rsquo;t&rsquo;</td>
</tr>
<tr>
<td>with_email</td>
<td>Adresse mail renseignée</td>
<td>&rsquo;t&rsquo;</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>201</td>
<td>Created</td>
</tr>
</tbody></table>

<h2 id="mise-jour">Mise à jour</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"json"</span><span class="p">:</span><span class="w"> </span><span class="s2">"idem création"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"json"</span><span class="p">:</span><span class="w"> </span><span class="s2">"idem création"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de modifier une cible</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">PUT /api/targets</code></p>

<p><code class="prettyprint">PATCH /api/targets</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p>idem création</p>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="visualisation">Visualisation</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CAC539ED500841229765A503715B0312"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne n°1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-05 07:29:12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-05 07:29:12"</span><span class="p">,</span><span class="w">  
  </span><span class="nt">"file_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EA8C650C379E4D7C921085A39D3084D5"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BADAD0FA3EAF46CBA11CF2348F85B8F4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne_201670292"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"synced_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"D56EFC4B67084B168E9DC723F9D6F77A"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customers_count"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de voir une cible</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/targets/{target_id}</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>target_id</td>
<td>path</td>
<td>UUID de la cible</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="suppression">Suppression</h2>

<p>Permet de supprimer une cible</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE /api/targets/{target_id}</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>target_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="rafraichissement">Rafraichissement</h2>

<p>Permet de rafraichir une cible</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/targets/{target_id}/refresh</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>target_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="liste">Liste</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"targets"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CAC539ED500841229765A503715B0312"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne n°1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-05 07:29:12"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-05 07:29:12"</span><span class="p">,</span><span class="w">  
      </span><span class="nt">"file_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EA8C650C379E4D7C921085A39D3084D5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BADAD0FA3EAF46CBA11CF2348F85B8F4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Campagne_201670292"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"synced_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"D56EFC4B67084B168E9DC723F9D6F77A"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customers_count"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer la liste des cibles</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/targets</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>search</td>
<td>path</td>
<td>Filtre les cibles par leur titre</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="upload">Upload</h2>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1234587A32784B168E9DC723F9D6F77A"</span><span class="w">            
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet d&#39;envoyer un fichier contenant des clients.Le fichier doit contenir un UUID par ligne.</p>

<p>La requête retourne un UUID qui peut-être utilisé lors de la création/mise à jour d&#39;une cible (file_id).</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/targets/upload</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Content-type</td>
<td>header</td>
<td>multipart/form-data</td>
</tr>
<tr>
<td>file</td>
<td>body</td>
<td> fichier contenant les uuid clients</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

          <h1 id="gifts-obsol-te">Gifts (Obsolète)</h1>

<h2 id="client">Client</h2>

<aside class="warning">Cette api est obsolète utilisez <a href="#gains">Gains</a></aside>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"gifts"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"10€ de bon d’achat"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"points"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
      </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"25.00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E23X45TT"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de récupérer la liste des cadeaux consommables par le client.</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/gifts</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td> query</td>
<td> UUID du client</td>
</tr>
<tr>
<td>used</td>
<td>query</td>
<td>Filtrer les cadeaux déjà offerts (facultatif)</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>201</td>
<td>CREATED</td>
</tr>
<tr>
<td>404</td>
<td>NOT FOUND</td>
</tr>
</tbody></table>

<aside class="notice">
La propriété &ldquo;points&rdquo;, du retour correspond au nombre de points collectés sur la carte correspondant au cadeau. Cette propriété n’est disponible que lors de l’appel des cadeaux disponibles.
</aside>

<h2 id="consommation">Consommation</h2>

<aside class="warning">Cette api est obsolète utilisez <a href="#gains">Gains</a></aside>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"AZEFDFD39A1AA85AC423JJL34NEZOJ3E"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet d’indiquer que le customer a consommé le cadeau.</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/gifts/award</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>uuid</td>
<td> body</td>
<td> UUID du cadeaux</td>
</tr>
<tr>
<td>customer_id</td>
<td> body</td>
<td> UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
<tr>
<td>404</td>
<td>NOT FOUND</td>
</tr>
</tbody></table>

<h2 id="restauration">Restauration</h2>

<aside class="warning">Cette api est obsolète utilisez <a href="#gains">Gains</a></aside>

<p>Permet d’annuler la consommation d’un cadeau</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE /api/gifts/{gift_id}</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>gift_id</td>
<td> path</td>
<td> UUID du cadeaux</td>
</tr>
<tr>
<td>customer_id</td>
<td> query</td>
<td> UUID du client</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
<tr>
<td>404</td>
<td>NOT FOUND</td>
</tr>
</tbody></table>

          <h1 id="gains-speciaux-obsol-te">Gains Speciaux (Obsolète)</h1>

<h2 id="liste">Liste</h2>

<aside class="warning">Cette api est obsolète utilisez <a href="#gains">Gains</a></aside>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"special_gains"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6DB912771BCA41A2ZZZDDA9C02A8B24B8"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5EE4E32CA6A4AA31EAAB68C381E4A825E"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"84D4B5BB95SSS31C12736ED9779E77E"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cadeau spécial"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"gived_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-09-30 08:00:09"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-02-24 10:45:18"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-30"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0BEB6DDDVVAFA43AA859567F67C4480AB"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"card_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A6700E63DDFDFD5A78E12C387845B90E7"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"image_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E23X45TT"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"web"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de voir la liste des cadeaux spéciaux d&#39;un client</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/customers/{customer_id}/specialgains</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td>path</td>
<td>UUID du client</td>
</tr>
<tr>
<td>used</td>
<td>query</td>
<td>Filtre les gains consommés</td>
</tr>
<tr>
<td>web</td>
<td>query</td>
<td>Filtre les gains consommables uniquement sur le web</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h2 id="consommation">Consommation</h2>

<aside class="warning">Cette api est obsolète utilisez <a href="#gains">Gains</a></aside>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E23X45TT"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet de consommer un cadeau spécial</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET api/specialgains/{specialgain_id}/valid</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>specialgain_id</td>
<td>path</td>
<td>UUID du cadeau special</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>ok</td>
</tr>
</tbody></table>

<h2 id="annuler-la-consommation">Annuler la consommation</h2>

<aside class="warning">Cette api est obsolète utilisez <a href="#gains">Gains</a></aside>

<blockquote>
<p>Resultat JSON</p>
</blockquote>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"uuid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FD39A1AA85AC4F3FB977DEA5A5786263"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E23X45TT"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permet d&#39;annuler la consommation d&#39;un cadeau spécial</p>

<h3 id="authentification">Authentification</h3>

<p>Type : <a href="#shop">Shop</a></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET api/specialgains/{specialgain_id}/unvalid</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>specialgain_id</td>
<td>path</td>
<td>UUID du cadeau special</td>
</tr>
</tbody></table>

<h3 id="return-code">Return code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>ok</td>
</tr>
</tbody></table>

          <h1 id="errors">Errors</h1>

<p>L&#39;API Fidelisa utilise les codes d&#39;erreurs suivants:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Votre requête est erronée</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; Vous n&#39;avez pas les autorisations pour utiliser l&#39;API</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; L&#39;élément recherché est introuvable</td>
</tr>
<tr>
<td>422</td>
<td>Unprocessable entity &ndash; L’entité fournie avec la requête est incompréhensible ou incomplète.</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; Un problème est survenu sur le serveur</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="csharp">csharp</a>
          </div>
      </div>
    </div>
  </body>
</html>
